# 数据库知识点总结

- MongoDB属于文档型数据库  
- Hbase多用来存储海量数据  
- 不过在业务开发的web应用中使用最多的还是Mysql和Redis

### 1.什么是事务(Transation)
事务是数据库并发控制的基本单位，也可以看作是一系列SQL语句的集合，要么全部执行成功，要么全部执行失败进行回滚操作，从而保持数据库的完整性。

### 2.事务的ACID特性


|特性|描述|
|-----|-----|
|原子性(Atomicity) | 一个事务中所有操作全部完成或者失败
|一致性(Consistency)|事务开始和结束之后数据完整性没有被破坏
|隔离性(Isolation)|允许多个事务同时对数据库修改和读写
|持久性(Durability)|事务结束之后，修改是永远不会丢失的

### 3.高并发场景下的重复插入问题解决

- 使用数据库的唯一索引
- 使用队列异步写入
- 使用redis等实现分布式锁

### 4.乐观锁和悲观锁
1.悲观锁是先获取锁再进行操作。也就是一锁二查三更新
2.乐观锁先修改，更新的时候发现数据变了就执行回滚操作 
到底业务中选取哪一种锁还是要根据响应速度、冲突频率、重试代价来判断到底使用哪一种。


### 5.Mysql的数据类型
Char(字符串类型)、Varchar(数值类型)、Date(日期时间类型)
需要用列表形式总结以下


### 6. 两种存储引擎InnoDB和MyISAM的区别

- MyISAM不支持事务，InnoDB支持事务
- MyISAM不支持外键，InnoDB支持外键
- MyISAM只支持表锁，InnoDB支持行锁和表锁
- MyISAM支持全文索引，而InnoDB不支持


### 7.Mysql索引
**1.什么是索引？**   
索引是数据表中一个或者多个列进行排序的数据结构，Mysql实际使用的是B+Tree作为索引的数据结构(它只在叶子节点带有指向记录的指针，它是B-Tree也就是多路平衡查找树演变而来的)  
**2.为什么需要索引？**  
索引能够大幅提升检索速度，但也要根据具体情况进行创建索引，因为创建和更新索引本身也会消耗空间和时间

### 8.Mysql中索引的类型？

- 普通索引
- 唯一索引，索引列的值必须唯一
- 多列索引
- 主键索引(一个表只能有一个)
- 全文索引(InnoDB存储引擎不支持

### 9.什么时候需要建立索引？

- 经常用作查询条件的字段(WHERE条件)
- 经常用作一些表连接的字段
- 经常出现在order by,group by 之后的字段

创建索引的时候需要注意哪些？

- 作为索引的字段值尽量不要有大量相同值
- 索引的长度不要太长（比较耗费时间）
- 尽量避免重现空指None的情况，因为mysql很难对空指做查询优化

### 10.什么情况下索引会失效？出现了慢查询

- 以%开头的LIKE语句，模糊查询，这种情况无法利用索引。
- 出现隐式类型转换(输入的查询类型与数据库的类型不匹配)
- 没有满足最左前缀原则
原理就是当mysql的B+树中的key没有办法直接去比较的时候，索引就会失效，出现慢查询。

***
# Redis数据库

### 1.为什么使用缓存
(1)使用缓存可以大幅地缓解后端关系数据库的压力，比如有很多热点数据用户频繁的访问，给数据库造成了查询压力。
(2)减少响应时间:内存IO速度比磁盘快
(3)提升吞吐量：Redis等内存数据库单机就可以支撑很大并发量

### 2.简述Redis常用数据类型和使用场景？
1.String(字符串):用来实现简单的KV键值对存储，比如计数器
2.List(链表):实现双向链表，比如用户的关注、粉丝列表
3.Hash(哈希表):用来存储彼此相关信息的键值对
4.set(集合):存储不重复元素，比如用户的关注者
5.sorted set(有序集合):实时信息的排行榜

### 3.Redis有哪些持久化存储方式
1.快照方式：把数据快照放在硬盘二进制文件中，dump.rdb。快照的实现方式是指定时间间隔把Redis数据库状态保存到一个压缩的二进制文件中，并且rdb这个文件可以恢复数据库的状态.
优点是每隔一段时间执行一次持久化，记录它的时间段快照，可以很好的恢复到某一时间段的快照。缺点是某个时间段内数据库当机了，很有可能就丢失了整个时间间隔之内的数据。
2.AOF(Append Only File)：每一次写的命令追加到appendonly.aof文件中，这种实现方式一旦当机的话，不会像快照一样丢失很多数据。缺点就是文件比较大，恢复速度不如rgb文件的方式。
3.这两种持久化存储的方案可以修改redis的配置用来选择。

### 4.什么是Redis事务
将多个请求打包，一次性、按照顺序执行多个命令的机制。指的redis在执行打包命令的时候，不会去执行其他客户端的请求。
Redis通过MULTI,EXEC,WATCH等命令实现事务功能。


### 5.Redis如何实现分布式锁？
1.使用setnx实现加锁，可以同时通过expire添加超时时间
2.锁的value值可以使用一个随机的uuid或者特定的命名
3.释放锁的时候，通过uuid判断是否是该锁，是则执行delete释放锁。


### 6.你使用过哪种缓存的模式
1.Cache Aside:同时更新缓存和数据库。它指的就是首先从缓存中去获取数据，如果缓存中没有数据的话，再从数据库中去取数据，从数据库取完数据之后，然后再去设置缓存的值(这种方式最常见的模式)，但这个模式的缺点就是其实一旦我们使用到缓存就涉及到数据库跟缓存之间的数据一致性问题，如果说我们先更新数据库，然后再去更新缓存，这时候并发的写操作可能导致缓存读取的是脏数据，因为它没有办法去判断缓存是谁先更新的谁后更新的，所以我们一般实现这种模式的方式就是先更新数据库，然后第一时间删除缓存，等下次读取的时候没有相关的缓存，再去数据库提取数据重建缓存。



### 总结:
mysql考点:
1.mysql常用的数据类型
2.mysql中的事务
3.对索引的理解，因为很多出现数据库慢查询的情况都是因为索引设计不当而引起的，索引使用的B-Tree跟B+Tree要清楚它的工作原理。
4.什么时候去使用索引,有哪些注意事项？
5.编写SQL语句，要清楚内连接外连接的区别。


redis常考点:
 1.常用数据类型跟使用场景
 2.

